!function(d,n,o){n.wp=n.wp||{},n.wp.bbpc=n.wp.bbpc||{},n.wp.bbpc.helper={detect_msie:function(){var t=n.navigator.userAgent,e=t.indexOf("MSIE ");if(0<e)return parseInt(t.substring(e+5,t.indexOf(".",e)),10);if(0<t.indexOf("Trident/")){e=t.indexOf("rv:");return parseInt(t.substring(e+3,t.indexOf(".",e)),10)}return 99},get_selection:function(){var t="";return n.getSelection?t=n.getSelection():o.getSelection?t=o.getSelection():o.selection&&(t=o.selection.createRange().text),d.trim(t.toString())},file_extension:function(t){return t.substr(t.lastIndexOf(".")+1).toLowerCase()},is_tinymce:function(){var t=0<d("#bbp_topic_content").length?"bbp_topic_content":"bbp_reply_content";return bbpc_data.wp_editor&&!d("#"+t).is(":visible")},into_editor:function(t){var e,n=0<d("#bbp_topic_content").length?"bbp_topic_content":"bbp_reply_content";wp.bbpc.helper.is_tinymce()?(t+="<br/><br/>",tinymce.get(n).execCommand("mceInsertContent",!1,t)):(n=(e=d("#"+n)).val(),""!==d.trim(n)&&(t="\n\n"+t),e.val(n+(t+="\n\n")))},scroll_to_editor:function(){8<wp.bbpc.helper.detect_msie()?d("html, body").animate({scrollTop:d("#new-post").offset().top},1e3):o.location.href="#new-post",d(".bbp-the-content-wrapper textarea").focus()}},n.wp.bbpc.toolbox={bbcodes:{init:function(){d(".bbpc-bbcode-spoiler").each(function(){var t=d(this).data("hover"),e=d(this).data("color");d(this).hover(function(){d(this).css("background",t)},function(){d(this).css("background",e)})})}},quotes:{init:function(){d(o).on("click",".bbpc-link-quote",function(t){var e,n,o,b;t.preventDefault(),0<d("#bbp_reply_content").length&&(o=wp.bbpc.helper.get_selection(),e=d(this).data("id"),n=wp.bbpc.helper.is_tinymce()?"</br></br>":"\n",t=!0,""===o&&(t=!1,o=d("#bbpc-quote-wrapper-"+e).html()),o=(o=(o=(o=o.replace(/&nbsp;/g," ")).replace(/<\s*p[^>]*>/g,"")).replace(/<\s*\/\s*(p|br)\s*>|<\s*br\s*>/g,n)).trim(),o=d("<div>").html(o).html(),o="bbcode"===bbpc_data.quote.method?"postquote"==(b="postquote"!==bbpc_data.quote.bbcode||t?"quote":"postquote")?"["+b+" quote="+e+"]":"["+b+" quote="+e+"]"+o+"[/"+b+"]":(b=bbpc_data.quote.wrote.replace("%s",d(this).data("author")),'<blockquote class="bbpc-bbcode-quote">'+('<div class="bbpc-quote-title"><a href="'+d(this).data("url")+'">'+b+":</a></div>")+o+"</blockquote>"),wp.bbpc.helper.into_editor(o),wp.bbpc.helper.scroll_to_editor())})}},canned_replies:{init:function(){d(".bbpc-canned-replies .bbpc-canned-replies-show").click(function(t){t.preventDefault();t=d(this).closest(".bbpc-canned-replies");d(this).hide(),d(".bbpc-canned-replies-hide",t).show(),d(".bbpc-canned-replies-list",t).slideDown()}),d(".bbpc-canned-replies .bbpc-canned-replies-hide").click(function(t){t.preventDefault();t=d(this).closest(".bbpc-canned-replies");d(this).hide(),d(".bbpc-canned-replies-show",t).show(),d(".bbpc-canned-replies-list",t).slideUp()}),d(".bbpc-canned-replies .bbpc-canned-reply-insert").click(function(t){t.preventDefault();var t=d(this).closest(".bbpc-canned-reply"),t=d(".bbpc-canned-reply-content",t).html();wp.bbpc.helper.into_editor(t),bbpc_data.canned_replies.auto_close_on_insert&&(t=d(this).closest(".bbpc-canned-replies"),d(".bbpc-canned-replies-hide",t).click())})}},fitvids:{init:function(){d(".bbp-topic-content, .bbp-reply-content").fitVids()}},report:{sending_report:!1,init:function(){d(".bbpc-link-report").click(function(t){t.preventDefault(),wp.bbpc.toolbox.report.sending_report||("form"===bbpc_data.report.mode?wp.bbpc.toolbox.report.form(d(this)):wp.bbpc.toolbox.report.button(d(this)))})},button:function(t){var e,n=t.data("id"),t=t.data("nonce");"confirm"===bbpc_data.report.mode&&!1===confirm(bbpc_data.report.confirm)||(e={post:n,nonce:t},wp.bbpc.toolbox.report.sending_report=!0,d.ajax({dataType:"html",type:"post",data:e,url:bbpc_data.url+"?action=bbpc_report_post",success:function(t){wp.bbpc.toolbox.report.sending_report=!1,d(".bbpc-link-report-"+e.post).replaceWith("<span>"+bbpc_data.report.after+"</span>")}}))},form:function(t){var e,n=t.data("id"),o=t.data("nonce"),t=t.closest("#bbpress-forums").find(".post-"+n+" .bbp-reply-content, .post-"+n+" .bbp-topic-content");1===t.length&&(0===t.find(".bbpc-report-wrapper").length&&(d(".bbpc-report-wrapper").remove(),(e=d(".bbpc-report-template > div").clone().addClass("bbpc-report-wrapper")).find("button").data("id",n).data("nonce",o),t.append(e),e.find("input").focus(),wp.bbpc.toolbox.report.handle(t.find(".bbpc-report-wrapper"))),bbpc_data.report.scroll&&((e=0)<d("#wpadminbar").length&&(e=d("#wpadminbar").height()),d("html, body").animate({scrollTop:t.find(".bbpc-report-wrapper").offset().top-e},500)))},handle:function(n){d("button.bbpc-report-cancel",n).click(function(){d(".bbpc-report-wrapper").remove()}),d("button.bbpc-report-send",n).click(function(){var e,t=d("input",n).val();t.length<bbpc_data.report.min?alert(bbpc_data.report.alert):(e={report:t,post:d(this).data("id"),nonce:d(this).data("nonce")},d(".bbpc-report-form",n).hide(),d(".bbpc-report-sending",n).show(),wp.bbpc.toolbox.report.sending_report=!0,d.ajax({dataType:"html",type:"post",data:e,url:bbpc_data.url+"?action=bbpc_report_post",success:function(t){wp.bbpc.toolbox.report.sending_report=!1,d(".bbpc-report-sending",n).hide(),d(".bbpc-report-sent",n).show(),d(".bbpc-link-report-"+e.post).replaceWith("<span>"+bbpc_data.report.after+"</span>")}}))})}},thanks:{init:function(){d(".bbpc-link-thanks, .bbpc-link-unthanks").click(function(t){t.preventDefault(),wp.bbpc.toolbox.thanks.handle(this)})},handle:function(t){var e={nonce:d(t).data("thanks-nonce"),say:d(t).data("thanks-action"),id:d(t).data("thanks-id")},n=d(t),o=n.hasClass("bbpc-link-thanks");d.ajax({dataType:"html",type:"post",data:e,url:bbpc_data.url+"?action=bbpc_say_thanks",success:function(t){t=d(t).fadeIn(600);d(".bbpc-thanks-post-"+e.id).fadeOut(400).replaceWith(t),o?bbpc_data.thanks.removal?n.removeClass("bbpc-link-thanks").addClass("bbpc-link-unthanks").data("thanks-action","unthanks").html(bbpc_data.thanks.unthanks):n.replaceWith("<span>"+bbpc_data.thanks.saved+"</span>"):n.removeClass("bbpc-link-unthanks").addClass("bbpc-link-thanks").data("thanks-action","thanks").html(bbpc_data.thanks.thanks)}})}},scheduler:{init:function(){var t,e=d("#bbpc_schedule_datetime");1===e.length&&(t=e.val(),t={enableTime:!0,enableSeconds:!0,altInput:!0,minDate:Date.now(),minTime:Date.now(),defaultDate:0===t.length?Date.now():t,dateFormat:"Y-m-d H:i:S"},""!==bbpc_data.flatpickr_locale&&(t.locale=bbpc_data.flatpickr_locale),e.flatpickr(t),d(o).on("change","#bbpc_schedule_when",function(){var t=d(this).val(),e=d(this).parent().parent().next();"future"===t?e.show():e.hide()}))}},misc:{privacy:function(){d(".bbpc-private-reply-hidden").each(function(){d(this).hide().prev(".bbp-reply-header").hide()})}},run:function(){"undefined"!=typeof bbpc_data&&(wp.bbpc.toolbox.misc.privacy(),-1<bbpc_data.load.indexOf("scheduler")&&wp.bbpc.toolbox.scheduler.init(),-1<bbpc_data.load.indexOf("quote")&&wp.bbpc.toolbox.quotes.init(),-1<bbpc_data.load.indexOf("bbcodes")&&wp.bbpc.toolbox.bbcodes.init(),-1<bbpc_data.load.indexOf("report")&&wp.bbpc.toolbox.report.init(),-1<bbpc_data.load.indexOf("thanks")&&wp.bbpc.toolbox.thanks.init(),-1<bbpc_data.load.indexOf("canned_replies")&&wp.bbpc.toolbox.canned_replies.init(),-1<bbpc_data.load.indexOf("fitvids")&&d.fn.fitVids&&wp.bbpc.toolbox.fitvids.init())}},d(o).ready(function(){wp.bbpc.toolbox.run(),"object"==typeof EnlighterJS&&EnlighterJS.init("pre.bbpc-bbcode-scode")})}(jQuery,window,document);